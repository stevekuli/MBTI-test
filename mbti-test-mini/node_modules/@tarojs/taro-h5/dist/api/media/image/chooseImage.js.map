{"version":3,"file":"chooseImage.js","sources":["../../../../src/api/media/image/chooseImage.ts"],"sourcesContent":["import Taro from '@tarojs/api'\n\nimport { shouldBeObject } from '../../../utils'\nimport { chooseMedia } from '../video/chooseMedia'\n\n/**\n * 从本地相册选择图片或使用相机拍照。\n * @deprecated 请使用 chooseMedia 接口\n */\nexport const chooseImage: typeof Taro.chooseImage = function (options) {\n  // options must be an Object\n  const isObject = shouldBeObject(options)\n  if (!isObject.flag) {\n    const res = { errMsg: `chooseImage:fail ${isObject.msg}` }\n    console.error(res.errMsg)\n    return Promise.reject(res)\n  }\n\n  let camera = 'back'\n  const {\n    sourceType = ['album', 'camera'],\n    success,\n    complete,\n    fail,\n    ...args\n  } = options\n  if (sourceType.includes('camera') && sourceType.indexOf('user') > -1) {\n    camera = 'front'\n  }\n\n  function parseRes (res: Taro.chooseMedia.SuccessCallbackResult): Taro.chooseImage.SuccessCallbackResult {\n    const { tempFiles = [], errMsg } = res\n    return {\n      tempFilePaths: tempFiles.map(item => item.tempFilePath),\n      tempFiles: tempFiles.map(item => ({\n        path: item.tempFilePath,\n        size: item.size,\n        type: item.fileType,\n        originalFileObj: item.originalFileObj,\n      })),\n      errMsg,\n    }\n  }\n\n  return chooseMedia({\n    mediaId: 'taroChooseImage',\n    ...args,\n    sourceType: sourceType as Taro.chooseMedia.Option['sourceType'],\n    mediaType: ['image'],\n    camera,\n    success: (res) => {\n      const param = parseRes(res)\n      success?.(param)\n      complete?.(param)\n    },\n    fail: (err) => {\n      fail?.(err)\n      complete?.(err)\n    },\n  }, 'chooseImage').then(parseRes)\n}\n"],"names":[],"mappings":";;;;AAKA;;;AAGG;AACI,MAAM,WAAW,GAA4B,UAAU,OAAO,EAAA;;AAEnE,IAAA,MAAM,QAAQ,GAAG,cAAc,CAAC,OAAO,CAAC,CAAA;AACxC,IAAA,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE;QAClB,MAAM,GAAG,GAAG,EAAE,MAAM,EAAE,CAAoB,iBAAA,EAAA,QAAQ,CAAC,GAAG,CAAE,CAAA,EAAE,CAAA;AAC1D,QAAA,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAA;AACzB,QAAA,OAAO,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;AAC3B,KAAA;IAED,IAAI,MAAM,GAAG,MAAM,CAAA;IACnB,MAAM,EACJ,UAAU,GAAG,CAAC,OAAO,EAAE,QAAQ,CAAC,EAChC,OAAO,EACP,QAAQ,EACR,IAAI,EAEF,GAAA,OAAO,EADN,IAAI,UACL,OAAO,EANL,CAML,YAAA,EAAA,SAAA,EAAA,UAAA,EAAA,MAAA,CAAA,CAAU,CAAA;AACX,IAAA,IAAI,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,UAAU,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,EAAE;QACpE,MAAM,GAAG,OAAO,CAAA;AACjB,KAAA;IAED,SAAS,QAAQ,CAAE,GAA2C,EAAA;QAC5D,MAAM,EAAE,SAAS,GAAG,EAAE,EAAE,MAAM,EAAE,GAAG,GAAG,CAAA;QACtC,OAAO;AACL,YAAA,aAAa,EAAE,SAAS,CAAC,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,YAAY,CAAC;YACvD,SAAS,EAAE,SAAS,CAAC,GAAG,CAAC,IAAI,KAAK;gBAChC,IAAI,EAAE,IAAI,CAAC,YAAY;gBACvB,IAAI,EAAE,IAAI,CAAC,IAAI;gBACf,IAAI,EAAE,IAAI,CAAC,QAAQ;gBACnB,eAAe,EAAE,IAAI,CAAC,eAAe;AACtC,aAAA,CAAC,CAAC;YACH,MAAM;SACP,CAAA;KACF;IAED,OAAO,WAAW,CAChB,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,OAAO,EAAE,iBAAiB,IACvB,IAAI,CAAA,EAAA,EACP,UAAU,EAAE,UAAmD,EAC/D,SAAS,EAAE,CAAC,OAAO,CAAC,EACpB,MAAM,EACN,OAAO,EAAE,CAAC,GAAG,KAAI;AACf,YAAA,MAAM,KAAK,GAAG,QAAQ,CAAC,GAAG,CAAC,CAAA;AAC3B,YAAA,OAAO,aAAP,OAAO,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAP,OAAO,CAAG,KAAK,CAAC,CAAA;AAChB,YAAA,QAAQ,aAAR,QAAQ,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAR,QAAQ,CAAG,KAAK,CAAC,CAAA;AACnB,SAAC,EACD,IAAI,EAAE,CAAC,GAAG,KAAI;AACZ,YAAA,IAAI,aAAJ,IAAI,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAJ,IAAI,CAAG,GAAG,CAAC,CAAA;AACX,YAAA,QAAQ,aAAR,QAAQ,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAR,QAAQ,CAAG,GAAG,CAAC,CAAA;SAChB,EAAA,CAAA,EACA,aAAa,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;AAClC;;;;"}