{"version":3,"file":"system.js","sources":["../../../src/api/base/system.ts"],"sourcesContent":["import Taro from '@tarojs/api'\nimport platform from 'platform'\n\nimport { temporarilyNotSupport } from '../../utils'\nimport { MethodHandler } from '../../utils/handler'\n\n/** 跳转系统蓝牙设置页 */\nexport const openSystemBluetoothSetting = /* @__PURE__ */ temporarilyNotSupport('openSystemBluetoothSetting')\n\n/** 跳转系统微信授权管理页 */\nexport const openAppAuthorizeSetting = /* @__PURE__ */ temporarilyNotSupport('openAppAuthorizeSetting')\n\n/** 获取窗口信息 */\nexport const getWindowInfo: typeof Taro.getWindowInfo = () => {\n  const info: ReturnType<typeof Taro.getWindowInfo> = {\n    /** 设备像素比 */\n    pixelRatio: window.devicePixelRatio,\n    /** 屏幕宽度，单位px */\n    screenWidth: window.screen.width,\n    /** 屏幕高度，单位px */\n    screenHeight: window.screen.height,\n    /** 可使用窗口宽度，单位px */\n    windowWidth: document.documentElement.clientWidth,\n    /** 可使用窗口高度，单位px */\n    windowHeight: document.documentElement.clientHeight,\n    /** 状态栏的高度，单位px */\n    statusBarHeight: NaN,\n    /** 在竖屏正方向下的安全区域 */\n    safeArea: {\n      bottom: 0,\n      height: 0,\n      left: 0,\n      right: 0,\n      top: 0,\n      width: 0\n    }\n  }\n\n  return info\n}\n\n/** 获取设备设置 */\nexport const getSystemSetting: typeof Taro.getSystemSetting = () => {\n  const isLandscape = window.screen.width >= window.screen.height\n  const info: ReturnType<typeof Taro.getSystemSetting> = {\n    /** 蓝牙的系统开关 */\n    bluetoothEnabled: false,\n    /** 地理位置的系统开关 */\n    locationEnabled: false,\n    /** Wi-Fi 的系统开关 */\n    wifiEnabled: false,\n    /** 设备方向 */\n    deviceOrientation: isLandscape ? 'landscape' : 'portrait'\n  }\n\n  return info\n}\n\n/** 获取设备设置 */\nexport const getDeviceInfo: typeof Taro.getDeviceInfo = () => {\n  const info: ReturnType<typeof Taro.getDeviceInfo> = {\n    /** 应用二进制接口类型（仅 Android 支持） */\n    abi: '',\n    /** 设备二进制接口类型（仅 Android 支持） */\n    deviceAbi: '',\n    /** 设备性能等级（仅Android小游戏）。取值为：-2 或 0（该设备无法运行小游戏），-1（性能未知），>=1（设备性能值，该值越高，设备性能越好，目前最高不到50） */\n    benchmarkLevel: -1,\n    /** 设备品牌 */\n    brand: platform.manufacturer || 'unknown',\n    /** 设备型号 */\n    model: platform.product || 'unknown',\n    /** 操作系统及版本 */\n    system: platform.os?.toString() || 'unknown',\n    /** 客户端平台 */\n    platform: platform.os?.family || 'unknown',\n    /** 设备二进制接口类型（仅 Android 支持） */\n    CPUType: '',\n  }\n\n  return info\n}\n\n/** 获取微信APP基础信息 */\nexport const getAppBaseInfo: typeof Taro.getAppBaseInfo = () => {\n  let isDarkMode = false\n  if (window.matchMedia?.('(prefers-color-scheme: dark)').matches) {\n    isDarkMode = true\n  }\n\n  const info: ReturnType<typeof Taro.getAppBaseInfo> = {\n    /** 客户端基础库版本 */\n    SDKVersion: '',\n    /** 是否已打开调试。可通过右上角菜单或 [Taro.setEnableDebug](/docs/apis/base/debug/setEnableDebug) 打开调试。 */\n    enableDebug: process.env.NODE_ENV !== 'production',\n    /** 当前小程序运行的宿主环境 */\n    // host: { appId: '' },\n    /** 微信设置的语言 */\n    language: navigator.language,\n    /** 微信版本号 */\n    version: '',\n    /** 系统当前主题，取值为light或dark，全局配置\"darkmode\":true时才能获取，否则为 undefined （不支持小游戏） */\n    theme: isDarkMode ? 'dark' : 'light'\n  }\n\n  return info\n}\n\n/** 获取微信APP授权设置 */\nexport const getAppAuthorizeSetting: typeof Taro.getAppAuthorizeSetting = () => {\n  const info: ReturnType<typeof Taro.getAppAuthorizeSetting> = {\n    /** 允许微信使用相册的开关（仅 iOS 有效） */\n    albumAuthorized: 'not determined',\n    /** 允许微信使用蓝牙的开关（仅 iOS 有效） */\n    bluetoothAuthorized: 'not determined',\n    /** 允许微信使用摄像头的开关 */\n    cameraAuthorized: 'not determined',\n    /** 允许微信使用定位的开关 */\n    locationAuthorized: 'not determined',\n    /** 定位准确度。true 表示模糊定位，false 表示精确定位（仅 iOS 有效） */\n    locationReducedAccuracy: false,\n    /** 允许微信使用麦克风的开关 */\n    microphoneAuthorized: 'not determined',\n    /** 允许微信通知的开关 */\n    notificationAuthorized: 'not determined',\n    /** 允许微信通知带有提醒的开关（仅 iOS 有效） */\n    notificationAlertAuthorized: 'not determined',\n    /** 允许微信通知带有标记的开关（仅 iOS 有效） */\n    notificationBadgeAuthorized: 'not determined',\n    /** 允许微信通知带有声音的开关（仅 iOS 有效） */\n    notificationSoundAuthorized: 'not determined',\n    /** 允许微信使用日历的开关 */\n    phoneCalendarAuthorized: 'not determined'\n  }\n\n  return info\n}\n\n/** 获取设备设置 */\nexport const getSystemInfoSync: typeof Taro.getSystemInfoSync = () => {\n  const windowInfo = getWindowInfo()\n  const systemSetting = getSystemSetting()\n  const deviceInfo: Taro.getDeviceInfo.Result = getDeviceInfo()\n  const appBaseInfo = getAppBaseInfo()\n  const appAuthorizeSetting = getAppAuthorizeSetting()\n  delete deviceInfo.abi\n\n  const info: ReturnType<typeof Taro.getSystemInfoSync> = {\n    ...windowInfo,\n    ...systemSetting,\n    ...deviceInfo,\n    ...appBaseInfo,\n    /** 用户字体大小（单位px）。以微信客户端「我-设置-通用-字体大小」中的设置为准 */\n    fontSizeSetting: NaN,\n    /** 允许微信使用相册的开关（仅 iOS 有效） */\n    albumAuthorized: appAuthorizeSetting.albumAuthorized === 'authorized',\n    /** 允许微信使用摄像头的开关 */\n    cameraAuthorized: appAuthorizeSetting.cameraAuthorized === 'authorized',\n    /** 允许微信使用定位的开关 */\n    locationAuthorized: appAuthorizeSetting.locationAuthorized === 'authorized',\n    /** 允许微信使用麦克风的开关 */\n    microphoneAuthorized: appAuthorizeSetting.microphoneAuthorized === 'authorized',\n    /** 允许微信通知的开关 */\n    notificationAuthorized: appAuthorizeSetting.notificationAuthorized === 'authorized',\n    /** 允许微信通知带有提醒的开关（仅 iOS 有效） */\n    notificationAlertAuthorized: appAuthorizeSetting.notificationAlertAuthorized === 'authorized',\n    /** 允许微信通知带有标记的开关（仅 iOS 有效） */\n    notificationBadgeAuthorized: appAuthorizeSetting.notificationBadgeAuthorized === 'authorized',\n    /** 允许微信通知带有声音的开关（仅 iOS 有效） */\n    notificationSoundAuthorized: appAuthorizeSetting.notificationSoundAuthorized === 'authorized',\n    /** 允许微信使用日历的开关 */\n    phoneCalendarAuthorized: appAuthorizeSetting.phoneCalendarAuthorized === 'authorized',\n    /** `true` 表示模糊定位，`false` 表示精确定位，仅 iOS 支持 */\n    locationReducedAccuracy: appAuthorizeSetting.locationReducedAccuracy,\n    /** 小程序当前运行环境 */\n    environment: ''\n  }\n\n  return info\n}\n\n/** 获取系统信息 */\nexport const getSystemInfoAsync: typeof Taro.getSystemInfoAsync = async (options = {}) => {\n  const { success, fail, complete } = options\n  const handle = new MethodHandler({ name: 'getSystemInfoAsync', success, fail, complete })\n\n  try {\n    const info = await getSystemInfoSync()\n    return handle.success(info)\n  } catch (error) {\n    return handle.fail({\n      errMsg: error\n    })\n  }\n}\n\n/** 获取系统信息 */\nexport const getSystemInfo: typeof Taro.getSystemInfo = async (options = {}) => {\n  const { success, fail, complete } = options\n  const handle = new MethodHandler({ name: 'getSystemInfo', success, fail, complete })\n\n  try {\n    const info = await getSystemInfoSync()\n    return handle.success(info)\n  } catch (error) {\n    return handle.fail({\n      errMsg: error\n    })\n  }\n}\n\nexport const getSkylineInfoSync = /* @__PURE__ */ temporarilyNotSupport('getSkylineInfoSync')\n\nexport const getSkylineInfo = /* @__PURE__ */ temporarilyNotSupport('getSkylineInfo')\n\nexport const getRendererUserAgent = /* @__PURE__ */ temporarilyNotSupport('getRendererUserAgent')\n"],"names":[],"mappings":";;;;;AAMA;AACa,MAAA,0BAA0B,mBAAmB,qBAAqB,CAAC,4BAA4B,EAAC;AAE7G;AACa,MAAA,uBAAuB,mBAAmB,qBAAqB,CAAC,yBAAyB,EAAC;AAEvG;AACO,MAAM,aAAa,GAA8B,MAAK;AAC3D,IAAA,MAAM,IAAI,GAA0C;;QAElD,UAAU,EAAE,MAAM,CAAC,gBAAgB;;AAEnC,QAAA,WAAW,EAAE,MAAM,CAAC,MAAM,CAAC,KAAK;;AAEhC,QAAA,YAAY,EAAE,MAAM,CAAC,MAAM,CAAC,MAAM;;AAElC,QAAA,WAAW,EAAE,QAAQ,CAAC,eAAe,CAAC,WAAW;;AAEjD,QAAA,YAAY,EAAE,QAAQ,CAAC,eAAe,CAAC,YAAY;;AAEnD,QAAA,eAAe,EAAE,GAAG;;AAEpB,QAAA,QAAQ,EAAE;AACR,YAAA,MAAM,EAAE,CAAC;AACT,YAAA,MAAM,EAAE,CAAC;AACT,YAAA,IAAI,EAAE,CAAC;AACP,YAAA,KAAK,EAAE,CAAC;AACR,YAAA,GAAG,EAAE,CAAC;AACN,YAAA,KAAK,EAAE,CAAC;AACT,SAAA;KACF,CAAA;AAED,IAAA,OAAO,IAAI,CAAA;AACb,EAAC;AAED;AACO,MAAM,gBAAgB,GAAiC,MAAK;AACjE,IAAA,MAAM,WAAW,GAAG,MAAM,CAAC,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,MAAM,CAAC,MAAM,CAAA;AAC/D,IAAA,MAAM,IAAI,GAA6C;;AAErD,QAAA,gBAAgB,EAAE,KAAK;;AAEvB,QAAA,eAAe,EAAE,KAAK;;AAEtB,QAAA,WAAW,EAAE,KAAK;;QAElB,iBAAiB,EAAE,WAAW,GAAG,WAAW,GAAG,UAAU;KAC1D,CAAA;AAED,IAAA,OAAO,IAAI,CAAA;AACb,EAAC;AAED;AACO,MAAM,aAAa,GAA8B,MAAK;;AAC3D,IAAA,MAAM,IAAI,GAA0C;;AAElD,QAAA,GAAG,EAAE,EAAE;;AAEP,QAAA,SAAS,EAAE,EAAE;;QAEb,cAAc,EAAE,CAAC,CAAC;;AAElB,QAAA,KAAK,EAAE,QAAQ,CAAC,YAAY,IAAI,SAAS;;AAEzC,QAAA,KAAK,EAAE,QAAQ,CAAC,OAAO,IAAI,SAAS;;QAEpC,MAAM,EAAE,CAAA,CAAA,EAAA,GAAA,QAAQ,CAAC,EAAE,MAAE,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAA,QAAQ,EAAE,KAAI,SAAS;;QAE5C,QAAQ,EAAE,CAAA,CAAA,EAAA,GAAA,QAAQ,CAAC,EAAE,MAAA,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,EAAA,CAAE,MAAM,KAAI,SAAS;;AAE1C,QAAA,OAAO,EAAE,EAAE;KACZ,CAAA;AAED,IAAA,OAAO,IAAI,CAAA;AACb,EAAC;AAED;AACO,MAAM,cAAc,GAA+B,MAAK;;IAC7D,IAAI,UAAU,GAAG,KAAK,CAAA;IACtB,IAAI,CAAA,EAAA,GAAA,MAAM,CAAC,UAAU,uDAAG,8BAA8B,CAAA,CAAE,OAAO,EAAE;QAC/D,UAAU,GAAG,IAAI,CAAA;AAClB,KAAA;AAED,IAAA,MAAM,IAAI,GAA2C;;AAEnD,QAAA,UAAU,EAAE,EAAE;;AAEd,QAAA,WAAW,EAAE,OAAO,CAAC,GAAG,CAAC,QAAQ,KAAK,YAAY;;;;QAIlD,QAAQ,EAAE,SAAS,CAAC,QAAQ;;AAE5B,QAAA,OAAO,EAAE,EAAE;;QAEX,KAAK,EAAE,UAAU,GAAG,MAAM,GAAG,OAAO;KACrC,CAAA;AAED,IAAA,OAAO,IAAI,CAAA;AACb,EAAC;AAED;AACO,MAAM,sBAAsB,GAAuC,MAAK;AAC7E,IAAA,MAAM,IAAI,GAAmD;;AAE3D,QAAA,eAAe,EAAE,gBAAgB;;AAEjC,QAAA,mBAAmB,EAAE,gBAAgB;;AAErC,QAAA,gBAAgB,EAAE,gBAAgB;;AAElC,QAAA,kBAAkB,EAAE,gBAAgB;;AAEpC,QAAA,uBAAuB,EAAE,KAAK;;AAE9B,QAAA,oBAAoB,EAAE,gBAAgB;;AAEtC,QAAA,sBAAsB,EAAE,gBAAgB;;AAExC,QAAA,2BAA2B,EAAE,gBAAgB;;AAE7C,QAAA,2BAA2B,EAAE,gBAAgB;;AAE7C,QAAA,2BAA2B,EAAE,gBAAgB;;AAE7C,QAAA,uBAAuB,EAAE,gBAAgB;KAC1C,CAAA;AAED,IAAA,OAAO,IAAI,CAAA;AACb,EAAC;AAED;AACO,MAAM,iBAAiB,GAAkC,MAAK;AACnE,IAAA,MAAM,UAAU,GAAG,aAAa,EAAE,CAAA;AAClC,IAAA,MAAM,aAAa,GAAG,gBAAgB,EAAE,CAAA;AACxC,IAAA,MAAM,UAAU,GAA8B,aAAa,EAAE,CAAA;AAC7D,IAAA,MAAM,WAAW,GAAG,cAAc,EAAE,CAAA;AACpC,IAAA,MAAM,mBAAmB,GAAG,sBAAsB,EAAE,CAAA;IACpD,OAAO,UAAU,CAAC,GAAG,CAAA;IAErB,MAAM,IAAI,6EACL,UAAU,CAAA,EACV,aAAa,CACb,EAAA,UAAU,GACV,WAAW,CAAA,EAAA;;AAEd,QAAA,eAAe,EAAE,GAAG;;AAEpB,QAAA,eAAe,EAAE,mBAAmB,CAAC,eAAe,KAAK,YAAY;;AAErE,QAAA,gBAAgB,EAAE,mBAAmB,CAAC,gBAAgB,KAAK,YAAY;;AAEvE,QAAA,kBAAkB,EAAE,mBAAmB,CAAC,kBAAkB,KAAK,YAAY;;AAE3E,QAAA,oBAAoB,EAAE,mBAAmB,CAAC,oBAAoB,KAAK,YAAY;;AAE/E,QAAA,sBAAsB,EAAE,mBAAmB,CAAC,sBAAsB,KAAK,YAAY;;AAEnF,QAAA,2BAA2B,EAAE,mBAAmB,CAAC,2BAA2B,KAAK,YAAY;;AAE7F,QAAA,2BAA2B,EAAE,mBAAmB,CAAC,2BAA2B,KAAK,YAAY;;AAE7F,QAAA,2BAA2B,EAAE,mBAAmB,CAAC,2BAA2B,KAAK,YAAY;;AAE7F,QAAA,uBAAuB,EAAE,mBAAmB,CAAC,uBAAuB,KAAK,YAAY;;QAErF,uBAAuB,EAAE,mBAAmB,CAAC,uBAAuB;;QAEpE,WAAW,EAAE,EAAE,EAAA,CAChB,CAAA;AAED,IAAA,OAAO,IAAI,CAAA;AACb,EAAC;AAED;MACa,kBAAkB,GAAmC,CAAO,OAAO,GAAG,EAAE,KAAI,SAAA,CAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,aAAA;IACvF,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,OAAO,CAAA;AAC3C,IAAA,MAAM,MAAM,GAAG,IAAI,aAAa,CAAC,EAAE,IAAI,EAAE,oBAAoB,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAA;IAEzF,IAAI;AACF,QAAA,MAAM,IAAI,GAAG,MAAM,iBAAiB,EAAE,CAAA;AACtC,QAAA,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;AAC5B,KAAA;AAAC,IAAA,OAAO,KAAK,EAAE;QACd,OAAO,MAAM,CAAC,IAAI,CAAC;AACjB,YAAA,MAAM,EAAE,KAAK;AACd,SAAA,CAAC,CAAA;AACH,KAAA;AACH,CAAC,EAAA;AAED;MACa,aAAa,GAA8B,CAAO,OAAO,GAAG,EAAE,KAAI,SAAA,CAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,aAAA;IAC7E,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,OAAO,CAAA;AAC3C,IAAA,MAAM,MAAM,GAAG,IAAI,aAAa,CAAC,EAAE,IAAI,EAAE,eAAe,EAAE,OAAO,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,CAAA;IAEpF,IAAI;AACF,QAAA,MAAM,IAAI,GAAG,MAAM,iBAAiB,EAAE,CAAA;AACtC,QAAA,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;AAC5B,KAAA;AAAC,IAAA,OAAO,KAAK,EAAE;QACd,OAAO,MAAM,CAAC,IAAI,CAAC;AACjB,YAAA,MAAM,EAAE,KAAK;AACd,SAAA,CAAC,CAAA;AACH,KAAA;AACH,CAAC,EAAA;AAEY,MAAA,kBAAkB,mBAAmB,qBAAqB,CAAC,oBAAoB,EAAC;AAEhF,MAAA,cAAc,mBAAmB,qBAAqB,CAAC,gBAAgB,EAAC;AAExE,MAAA,oBAAoB,mBAAmB,qBAAqB,CAAC,sBAAsB;;;;"}