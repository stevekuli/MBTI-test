{"version":3,"file":"index.js","sources":["../../../../src/api/ui/animation/index.ts"],"sourcesContent":["import Taro from '@tarojs/api'\n\n/**\n * H5 下的 styleSheet 操作\n * @author leeenx\n */\nclass StyleSheet {\n  constructor () {\n    this.$style = document.createElement('style')\n  }\n\n  $style?: HTMLStyleElement | null = null\n  sheet?: CSSStyleSheet | null = null\n\n  appendStyleSheet = () => {\n    if (this.$style) {\n      const head = document.getElementsByTagName('head')[0]\n      this.$style.setAttribute('type', 'text/css')\n      this.$style.setAttribute('data-type', 'Taro')\n      head.appendChild(this.$style)\n      this.sheet = this.$style.sheet\n    }\n    if (this.sheet && !('insertRule' in this.sheet)) {\n      console.warn('当前浏览器不支持 stylesheet.insertRule 接口')\n    }\n  }\n\n  // 添加样式命令\n  add = (cssText, index = 0) => {\n    if (this.sheet === null) {\n      // $style 未插入到 DOM\n      this.appendStyleSheet()\n    }\n    this.sheet?.insertRule(cssText, index)\n  }\n}\n\nconst styleSheet = new StyleSheet()\n\n// 监听事件\nlet TRANSITION_END = 'transitionend'\nlet TRANSFORM = 'transform'\n\nconst $detect = document.createElement('div')\n$detect.style.cssText = '-webkit-animation-name:webkit;-moz-animation-name:moz;-ms-animation-name:ms;animation-name:standard;'\nif ($detect.style['animation-name'] === 'standard') {\n  // 支持标准写法\n  TRANSITION_END = 'transitionend'\n  TRANSFORM = 'transform'\n} else if ($detect.style['-webkit-animation-name'] === 'webkit') {\n  // webkit 前缀\n  TRANSITION_END = 'webkitTransitionEnd'\n  TRANSFORM = '-webkit-transform'\n} else if ($detect.style['-moz-animation-name'] === 'moz') {\n  // moz 前缀\n  TRANSITION_END = 'mozTransitionEnd'\n  TRANSFORM = '-moz-transform'\n} else if ($detect.style['-ms-animation-name'] === 'ms') {\n  // ms 前缀\n  TRANSITION_END = 'msTransitionEnd'\n  TRANSFORM = '-ms-transform'\n}\n\nlet animId = 0\n\ninterface IAnimationAttr {\n  duration: number\n  delay: number\n  timingFunction: string\n  transformOrigin: string\n}\n\ninterface IRule {\n  key: string\n  rule: string\n}\n\ninterface ITransform {\n  key: string\n  transform: string\n}\n\nclass Animation implements Taro.Animation {\n  unit: string\n  id: number\n  DEFAULT: IAnimationAttr\n\n  constructor (\n    {\n      duration = 400,\n      delay = 0,\n      timingFunction = 'linear',\n      transformOrigin = '50% 50% 0',\n      unit = 'px'\n    }: Taro.createAnimation.Option = {}\n  ) {\n    // 默认值\n    this.setDefault(duration, delay, timingFunction, transformOrigin)\n    this.unit = unit\n    // atom 环境下，animation 属性不会显示，所以要改成 data-animation\n    let animAttr = 'animation'\n    // 动画 id\n    this.id = ++animId\n    // 监听事件\n    document.body.addEventListener(TRANSITION_END, (e: TransitionEvent) => {\n      const target = e.target as HTMLElement\n      if (target.getAttribute(animAttr) === null) {\n        animAttr = 'data-animation'\n      }\n      const animData = target.getAttribute(animAttr)\n      // 没有动画存在\n      if (animData === null) return\n      const [animName, animPath] = animData.split('__')\n      if (animName === `taro-h5-poly-fill/${this.id}/create-animation`) {\n        const [animIndex, __stepIndex = 0] = animPath.split('--')\n        const stepIndex = Number(__stepIndex)\n        // 动画总的关键帧\n        const animStepsCount = this.animationMap[`${animName}__${animIndex}`]\n        const animStepsMaxIndex = animStepsCount - 1\n        if (stepIndex < animStepsMaxIndex) {\n          // 播放下一个关键帧（因为 nerv 和 react 有差异所以 animation & data-animation 都需要写）\n          target.setAttribute(animAttr, `${animName}__${animIndex}--${stepIndex + 1}`)\n          if (animAttr === 'data-animation') {\n            // Nerv 环境，animation & data-animation 双重保险\n            target.setAttribute('animation', `${animName}__${animIndex}--${stepIndex + 1}`)\n          }\n        }\n      }\n    })\n  }\n\n  transformUnit (...args) {\n    const ret: string[] = []\n    args.forEach(each => {\n      ret.push(isNaN(each) ? each : `${each}${this.unit}`)\n    })\n    return ret\n  }\n\n  // 设置默认值\n  setDefault (duration, delay, timingFunction, transformOrigin) {\n    this.DEFAULT = { duration, delay, timingFunction, transformOrigin }\n  }\n\n  // 属性组合\n  rules: IRule[] = []\n  // transform 对象\n  transform: ITransform[] = []\n  // 组合动画\n  steps: string[] = []\n  // 动画 map ----- 永久保留\n  animationMap = {}\n  // animationMap 的长度\n  animationMapCount = 0\n  // 历史动画\n  historyAnimations: ITransform[] = []\n  // 历史规则\n  historyRules: IRule[] = []\n\n  matrix (a: number, b: number, c: number, d: number, tx: number, ty: number) {\n    this.transform.push({ key: 'matrix', transform: `matrix(${a}, ${b}, ${c}, ${d}, ${tx}, ${ty})` })\n    return this\n  }\n\n  matrix3d (a1: number, b1: number, c1: number, d1: number, a2: number, b2: number, c2: number, d2: number, a3: number, b3: number, c3: number, d3: number, a4: number, b4: number, c4: number, d4: number) {\n    this.transform.push({\n      key: 'matrix3d',\n      transform: `matrix3d(${a1}, ${b1}, ${c1}, ${d1}, ${a2}, ${b2}, ${c2}, ${d2}, ${a3}, ${b3}, ${c3}, ${d3}, ${a4}, ${b4}, ${c4}, ${d4})`,\n    })\n    return this\n  }\n\n  rotate (angle: number) {\n    this.transform.push({ key: 'rotate', transform: `rotate(${angle}deg)` })\n    return this\n  }\n\n  rotate3d (x: number, y?: number, z?: number, angle?: number) {\n    if (typeof y !== 'number') {\n      this.transform.push({ key: 'rotate3d', transform: `rotate3d(${x})` })\n    } else {\n      this.transform.push({ key: 'rotate3d', transform: `rotate3d(${x}, ${y || 0}, ${z || 0}, ${angle || 0}deg)` })\n    }\n    return this\n  }\n\n  rotateX (angle) {\n    this.transform.push({ key: 'rotateX', transform: `rotateX(${angle}deg)` })\n    return this\n  }\n\n  rotateY (angle) {\n    this.transform.push({ key: 'rotateY', transform: `rotateY(${angle}deg)` })\n    return this\n  }\n\n  rotateZ (angle) {\n    this.transform.push({ key: 'rotateZ', transform: `rotateZ(${angle}deg)` })\n    return this\n  }\n\n  scale (x: number, y?: number) {\n    const scaleY = (typeof y !== 'undefined' && y !== null) ? y : x\n    this.transform.push({ key: 'scale', transform: `scale(${x}, ${scaleY})` })\n    return this\n  }\n\n  scale3d (x, y, z) {\n    this.transform.push({ key: 'scale3d', transform: `scale3d(${x}, ${y}, ${z})` })\n    return this\n  }\n\n  scaleX (scale) {\n    this.transform.push({ key: 'scaleX', transform: `scaleX(${scale})` })\n    return this\n  }\n\n  scaleY (scale) {\n    this.transform.push({ key: 'scaleY', transform: `scaleY(${scale})` })\n    return this\n  }\n\n  scaleZ (scale) {\n    this.transform.push({ key: 'scaleZ', transform: `scaleZ(${scale})` })\n    return this\n  }\n\n  skew (x, y) {\n    this.transform.push({ key: 'skew', transform: `skew(${x}deg, ${y}deg)` })\n    return this\n  }\n\n  skewX (angle) {\n    this.transform.push({ key: 'skewX', transform: `skewX(${angle}deg)` })\n    return this\n  }\n\n  skewY (angle) {\n    this.transform.push({ key: 'skewY', transform: `skewY(${angle}deg)` })\n    return this\n  }\n\n  translate (x, y) {\n    [x, y] = this.transformUnit(x, y)\n    this.transform.push({ key: 'translate', transform: `translate(${x}, ${y})` })\n    return this\n  }\n\n  translate3d (x, y, z) {\n    [x, y, z] = this.transformUnit(x, y, z)\n    this.transform.push({ key: 'translate3d', transform: `translate3d(${x}, ${y}, ${z})` })\n    return this\n  }\n\n  translateX (translate) {\n    [translate] = this.transformUnit(translate)\n    this.transform.push({ key: 'translateX', transform: `translateX(${translate})` })\n    return this\n  }\n\n  translateY (translate) {\n    [translate] = this.transformUnit(translate)\n    this.transform.push({ key: 'translateY', transform: `translateY(${translate})` })\n    return this\n  }\n\n  translateZ (translate) {\n    [translate] = this.transformUnit(translate)\n    this.transform.push({ key: 'translateZ', transform: `translateZ(${translate})` })\n    return this\n  }\n\n  opacity (value) {\n    this.rules.push({ key: 'opacity', rule: `opacity: ${value}` })\n    return this\n  }\n\n  backgroundColor (value) {\n    this.rules.push({ key: 'backgroundColor', rule: `background-color: ${value}` })\n    return this\n  }\n\n  width (value) {\n    [value] = this.transformUnit(value)\n    this.rules.push({ key: 'width', rule: `width: ${value}` })\n    return this\n  }\n\n  height (value) {\n    [value] = this.transformUnit(value)\n    this.rules.push({ key: 'height', rule: `height: ${value}` })\n    return this\n  }\n\n  top (value) {\n    [value] = this.transformUnit(value)\n    this.rules.push({ key: 'top', rule: `top: ${value}` })\n    return this\n  }\n\n  right (value) {\n    [value] = this.transformUnit(value)\n    this.rules.push({ key: 'right', rule: `right: ${value}` })\n    return this\n  }\n\n  bottom (value) {\n    [value] = this.transformUnit(value)\n    this.rules.push({ key: 'bottom', rule: `bottom: ${value}` })\n    return this\n  }\n\n  left (value) {\n    [value] = this.transformUnit(value)\n    this.rules.push({ key: 'left', rule: `left: ${value}` })\n    return this\n  }\n\n  // 关键帧载入\n  step (arg: Partial<IAnimationAttr> = {}) {\n    const { DEFAULT } = this\n    const {\n      duration = DEFAULT.duration,\n      delay = DEFAULT.delay,\n      timingFunction = DEFAULT.timingFunction,\n      transformOrigin = DEFAULT.transformOrigin,\n    } = arg\n    // 生成一条 transition 动画\n\n    this.transform.map((t0) => {\n      const index = this.historyAnimations.findIndex((t1) => t1.key === t0.key)\n      if (index === -1) {\n        this.historyAnimations.push(t0)\n      } else {\n        this.historyAnimations[index] = t0\n      }\n    })\n    const transforms = this.historyAnimations.map((t) => t.transform)\n    const transformSequence = transforms.length > 0 ? `${TRANSFORM}:${transforms.join(' ')}!important` : ''\n\n    this.rules.map((r0) => {\n      const index = this.historyRules.findIndex((r1) => r1.key === r0.key)\n      if (index === -1) {\n        this.historyRules.push(r0)\n      } else {\n        this.historyRules[index] = r0\n      }\n    })\n    const rules = this.historyRules.map((t) => t.rule)\n    const ruleSequence = rules.length > 0 ? rules.map((rule) => `${rule}!important`).join(';') : ''\n\n    this.steps.push(\n      [\n        ruleSequence,\n        transformSequence,\n        `${TRANSFORM}-origin: ${transformOrigin}`,\n        `transition: all ${duration}ms ${timingFunction} ${delay}ms`,\n      ]\n        .filter((item) => item !== '')\n        .join(';')\n    )\n    // 清空 rules 和 transform\n    this.rules = []\n    this.transform = []\n    return this as Taro.Animation\n  }\n\n  // 创建底层数据\n  createAnimationData () {\n    const animIndex = `taro-h5-poly-fill/${this.id}/create-animation__${this.animationMapCount++}`\n    // 记录动画分几个 step\n    this.animationMap[animIndex] = this.steps.length\n    // 吐出 step\n    this.steps.forEach((step, index) => {\n      const selector =\n        index === 0\n          ? `[animation=\"${animIndex}\"], [data-animation=\"${animIndex}\"]`\n          : `[animation=\"${animIndex}--${index}\"], [data-animation=\"${animIndex}--${index}\"]`\n      styleSheet.add(`${selector} { ${step} }`)\n    })\n\n    // 清空 steps\n    this.steps = []\n    return animIndex\n  }\n\n  // 动画数据产出\n  export () {\n    return this.createAnimationData() as unknown as ReturnType<Taro.Animation['export']>\n  }\n}\n\n// h5 的 createAnimation\nexport const createAnimation: typeof Taro.createAnimation = (option) => {\n  return new Animation(option)\n}\n"],"names":[],"mappings":"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"}