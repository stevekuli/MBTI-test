{"version":3,"file":"index.js","sources":["../../../src/components/view/index.tsx"],"sourcesContent":["import './style/index.css'\n\nimport classNames from 'classnames'\nimport React from 'react'\n\ninterface IProps extends React.HTMLAttributes<HTMLDivElement> {\n  hoverClass?: string\n  hoverStartTime?: number\n  hoverStayTime?: number\n  onTouchStart?(e: React.TouchEvent<HTMLDivElement>): void\n  onTouchEnd?(e: React.TouchEvent<HTMLDivElement>): void\n  onTouchMove?(e: React.TouchEvent<HTMLDivElement>): void\n  onLongPress?(): void\n}\n\ninterface IState {\n  hover: boolean\n  touch: boolean\n}\n\nclass View extends React.Component<IProps, IState> {\n  state = {\n    hover: false,\n    touch: false\n  }\n\n  timeoutEvent: ReturnType<typeof setTimeout>\n  startTime = 0\n\n  render () {\n    const {\n      className,\n      hoverClass,\n      onTouchStart,\n      onTouchEnd,\n      onTouchMove,\n      hoverStartTime = 50,\n      hoverStayTime = 400,\n      ...other\n    } = this.props\n\n    const cls = classNames(\n      '',\n      {\n        [`${hoverClass}`]: this.state.hover\n      },\n      className\n    )\n\n    const _onTouchStart = e => {\n      if (hoverClass) {\n        this.setState(() => ({\n          touch: true\n        }))\n        setTimeout(() => {\n          if (this.state.touch) {\n            this.setState(() => ({\n              hover: true\n            }))\n          }\n        }, hoverStartTime)\n      }\n      onTouchStart && onTouchStart(e)\n      if (this.props.onLongPress) {\n        this.timeoutEvent = setTimeout(() => {\n          this.props.onLongPress!()\n        }, 350)\n        this.startTime = new Date().getTime()\n      }\n    }\n\n    const _onTouchMove = e => {\n      clearTimeout(this.timeoutEvent)\n      onTouchMove && onTouchMove(e)\n    }\n\n    const _onTouchEnd = e => {\n      const spanTime = new Date().getTime() - this.startTime\n      if (spanTime < 350) {\n        clearTimeout(this.timeoutEvent)\n      }\n      if (hoverClass) {\n        this.setState(() => ({\n          touch: false\n        }))\n        setTimeout(() => {\n          if (!this.state.touch) {\n            this.setState(() => ({\n              hover: false\n            }))\n          }\n        }, hoverStayTime)\n      }\n      onTouchEnd && onTouchEnd(e)\n    }\n\n    return (\n      <div\n        className={cls}\n        onTouchStart={_onTouchStart}\n        onTouchEnd={_onTouchEnd}\n        onTouchMove={_onTouchMove}\n        {...other}\n      >\n        {this.props.children}\n      </div>\n    )\n  }\n}\n\nexport default View\n"],"names":["View","_React$Component","_inherits","_super","_createSuper","_this","_classCallCheck","state","hover","touch","startTime","_createClass","key","value","render","_this2","_a","props","className","hoverClass","onTouchStart","onTouchEnd","onTouchMove","_a$hoverStartTime","hoverStartTime","_a$hoverStayTime","hoverStayTime","other","__rest","cls","classNames","_defineProperty","concat","_onTouchStart","e","setState","setTimeout","onLongPress","timeoutEvent","Date","getTime","_onTouchMove","clearTimeout","_onTouchEnd","spanTime","React","createElement","Object","assign","children","Component"],"mappings":"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"}