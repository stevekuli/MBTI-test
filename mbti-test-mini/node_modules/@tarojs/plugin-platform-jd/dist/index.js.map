{"version":3,"file":"index.js","sources":["../src/components.ts","../src/template.ts","../src/program.ts","../src/index.ts"],"sourcesContent":["import { singleQuote } from '@tarojs/shared'\n\nexport const components = {\n  // ======== 调整属性 ========\n  Swiper: {\n    'easing-function': singleQuote('default')\n  },\n  Canvas: {\n    type: ''\n  },\n  Button: {\n    bindGetPhoneNumber: ''\n  },\n  Map: {\n    bindRegionChange: ''\n  },\n  WebView: {\n    height: ''\n  },\n  Input: {\n    'adjust-position': 'true',\n  },\n  Textarea: {\n    'show-confirm-bar': 'true',\n    'adjust-position': 'true',\n    'disable-default-padding': 'false',\n  },\n}\n","import { UnRecursiveTemplate } from '@tarojs/shared/dist/template'\n\nexport class Template extends UnRecursiveTemplate {\n  supportXS = true\n  Adapter = {\n    if: 'jd:if',\n    else: 'jd:else',\n    elseif: 'jd:elif',\n    for: 'jd:for',\n    forItem: 'jd:for-item',\n    forIndex: 'jd:for-index',\n    key: 'jd:key',\n    type: 'jd'\n  }\n\n  buildXsTemplate (filePath = './utils') {\n    return `<jds src=\"${filePath}.jds\" module=\"xs\" />`\n  }\n\n  replacePropName (name, value, componentName) {\n    if (value === 'eh') {\n      const nameLowerCase = name.toLowerCase()\n      if (nameLowerCase === 'bindlongtap' && componentName !== 'canvas') return 'bindlongpress'\n      return nameLowerCase\n    }\n    return name\n  }\n}\n","import { TaroPlatformBase } from '@tarojs/service'\n\nimport { components } from './components'\nimport { Template } from './template'\n\nconst PACKAGE_NAME = '@tarojs/plugin-platform-jd'\n\nexport default class JD extends TaroPlatformBase {\n  platform = 'jd'\n  globalObject = 'jd'\n  projectConfigJson = 'project.jd.json'\n  runtimePath = `${PACKAGE_NAME}/dist/runtime`\n  fileType = {\n    templ: '.jxml',\n    style: '.jxss',\n    config: '.json',\n    script: '.js',\n    xs: '.jds'\n  }\n\n  template = new Template()\n\n  /**\n   * 1. setupTransaction - init\n   * 2. setup\n   * 3. setupTransaction - close\n   * 4. buildTransaction - init\n   * 5. build\n   * 6. buildTransaction - close\n   */\n  constructor (ctx, config) {\n    super(ctx, config)\n\n    this.setupTransaction.addWrapper({\n      close: this.modifyTemplate\n    })\n  }\n\n  /**\n   * 增加组件或修改组件属性\n   */\n  modifyTemplate () {\n    this.template.mergeComponents(this.ctx, components)\n  }\n}\n","import { isString } from '@tarojs/shared'\n\nimport JD from './program'\n\nimport type { IPluginContext } from '@tarojs/service'\n\n// 让其它平台插件可以继承此平台\nexport { JD }\n\nexport default (ctx: IPluginContext) => {\n  ctx.registerPlatform({\n    name: 'jd',\n    useConfigName: 'mini',\n    async fn ({ config }) {\n      const program = new JD(ctx, config)\n      await program.start()\n    }\n  })\n\n  ctx.modifyRunnerOpts(({ opts }) => {\n    if (!opts?.compiler) return\n\n    if (isString(opts.compiler)) {\n      opts.compiler = {\n        type: opts.compiler\n      }\n    }\n    const { compiler } = opts\n    if (compiler.type === 'webpack5') {\n      compiler.prebundle ||= {}\n      const prebundleOptions = compiler.prebundle\n      if (prebundleOptions.enable === false) return\n      prebundleOptions.swc ||= {\n        jsc: {\n          target: 'es5'\n        }\n      }\n      prebundleOptions.exclude ||= []\n      prebundleOptions.include ||= []\n    }\n  })\n}\n"],"names":["singleQuote","UnRecursiveTemplate","TaroPlatformBase","isString"],"mappings":"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"}