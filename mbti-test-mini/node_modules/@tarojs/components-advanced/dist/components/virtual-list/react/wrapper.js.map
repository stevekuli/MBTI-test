{"version":3,"file":"wrapper.js","sources":["../../../../src/components/virtual-list/react/wrapper.ts"],"sourcesContent":["import React, { PropsWithChildren } from 'react'\n\nimport { convertPX2Int } from '../../../utils'\n\nimport type { BaseEventOrig } from '@tarojs/components'\nimport type { VirtualListProps } from '..'\nimport type { IProps } from '../preset'\n\nfunction getRenderExpandNodes ({\n  direction,\n  isHorizontal,\n  isRtl,\n  id: sid,\n  innerElement,\n  renderExpand,\n}: {\n  direction: 'top' | 'bottom' | 'left' | 'right'\n  isHorizontal: boolean\n  isRtl: boolean\n  id: string\n  innerElement: VirtualListProps['innerElementType']\n  renderExpand?: VirtualListProps['renderTop'] | VirtualListProps['renderBottom']\n}) {\n  const id = `${sid}-${direction}`\n  const props: any = {\n    key: id,\n    id,\n    style: {\n      visibility: 'hidden',\n      height: isHorizontal ? '100%' : 100,\n      width: isHorizontal ? 100 : '100%',\n      [isHorizontal ? isRtl ? 'marginRight' : 'marginLeft' : 'marginTop']: -100,\n      zIndex: -1,\n    }\n  }\n  const expands = [renderExpand, React.createElement(\n    innerElement!,\n    props,\n  )]\n  if (isHorizontal ? isRtl ? direction === 'right' : direction === 'left' : direction === 'top') {\n    expands.reverse()\n  }\n  return expands\n}\n\nconst outerWrapper = React.forwardRef(\n  function OuterWrapper (props, ref) {\n    const {\n      id = '', className, style = {}, children,\n      outerElementType, innerElementType,\n      onScroll, onScrollNative,\n      renderTop, renderBottom,\n      layout, direction,\n      ...rest\n    } = props as PropsWithChildren<IProps>\n    const handleScroll = (event: BaseEventOrig<VirtualListProps.IVirtualListEventDetail>) => {\n      onScroll?.({\n        ...event as any,\n        currentTarget: {\n          ...event.detail,\n          clientWidth: convertPX2Int(style.width),\n          clientHeight: convertPX2Int(style.height)\n        } as any\n      })\n\n      if (typeof onScrollNative === 'function') {\n        onScrollNative(event)\n      }\n    }\n    const isHorizontal = layout === 'horizontal'\n    const isRtl = direction === 'rtl'\n\n    return React.createElement<any>(outerElementType!, {\n      ref,\n      id,\n      className,\n      style,\n      scrollY: !isHorizontal,\n      scrollX: isHorizontal,\n      onScroll: handleScroll,\n      ...rest\n    }, [\n      getRenderExpandNodes({\n        direction: isHorizontal ? isRtl ? 'right' : 'left' : 'top',\n        isHorizontal,\n        isRtl,\n        id,\n        innerElement: innerElementType,\n        renderExpand: renderTop,\n      }),\n      children,\n      getRenderExpandNodes({\n        direction: isHorizontal ? isRtl ? 'left' : 'right' : 'bottom',\n        isHorizontal,\n        isRtl,\n        id,\n        innerElement: innerElementType,\n        renderExpand: renderBottom,\n      }),\n    ])\n  }\n)\n\nexport default outerWrapper\n"],"names":[],"mappings":"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"}