{"version":3,"file":"wrapper.js","sources":["../../../../src/components/virtual-waterfall/react/wrapper.ts"],"sourcesContent":["import React, { PropsWithChildren } from 'react'\n\nimport { convertPX2Int } from '../../../utils'\n\nimport type { BaseEventOrig } from '@tarojs/components'\nimport type { VirtualWaterfallProps } from '..'\nimport type { IProps } from '../preset'\n\nfunction getRenderExpandNodes ({\n  direction,\n  id: sid,\n  innerElement,\n  renderExpand,\n}: {\n  direction: 'top' | 'bottom'\n  id: string\n  innerElement: VirtualWaterfallProps['innerElementType']\n  renderExpand?: VirtualWaterfallProps['renderTop'] | VirtualWaterfallProps['renderBottom']\n}) {\n  const id = `${sid}-${direction}`\n  const props: any = {\n    key: id,\n    id,\n  }\n  if (!renderExpand) {\n    props.style = {\n      visibility: 'hidden',\n      height: 100,\n      marginTop: -100,\n      zIndex: -1,\n    }\n  }\n  return React.createElement(\n    renderExpand || innerElement,\n    props,\n  )\n}\n\nconst outerWrapper = React.forwardRef(\n  function OuterWrapper (props, ref) {\n    const {\n      id, className, style, children,\n      outerElementType, innerElementType,\n      onScroll, onScrollNative,\n      renderTop, renderBottom,\n      ...rest\n    } = props as PropsWithChildren<IProps>\n    const handleScroll = (event: BaseEventOrig<VirtualWaterfallProps.IVirtualWaterfallEventDetail>) => {\n      onScroll?.({\n        ...event as any,\n        currentTarget: {\n          ...event.detail,\n          clientWidth: convertPX2Int(style.width),\n          clientHeight: convertPX2Int(style.height)\n        } as any\n      })\n\n      if (typeof onScrollNative === 'function') {\n        onScrollNative(event)\n      }\n    }\n\n    return React.createElement<any>(outerElementType, {\n      ref,\n      id,\n      className,\n      style,\n      scrollY: true,\n      onScroll: handleScroll,\n      ...rest\n    }, [\n      getRenderExpandNodes({\n        direction: 'top',\n        id,\n        innerElement: innerElementType,\n        renderExpand: renderTop,\n      }),\n      children,\n      getRenderExpandNodes({\n        direction: 'bottom',\n        id,\n        innerElement: innerElementType,\n        renderExpand: renderBottom,\n      }),\n    ])\n  }\n)\n\nexport default outerWrapper\n"],"names":[],"mappings":";;;;;AAQA,SAAS,oBAAoB,CAAE,EAC7B,SAAS,EACT,EAAE,EAAE,GAAG,EACP,YAAY,EACZ,YAAY,GAMb,EAAA;AACC,IAAA,MAAM,EAAE,GAAG,CAAA,EAAG,GAAG,CAAI,CAAA,EAAA,SAAS,EAAE,CAAA;AAChC,IAAA,MAAM,KAAK,GAAQ;AACjB,QAAA,GAAG,EAAE,EAAE;QACP,EAAE;KACH,CAAA;IACD,IAAI,CAAC,YAAY,EAAE;QACjB,KAAK,CAAC,KAAK,GAAG;AACZ,YAAA,UAAU,EAAE,QAAQ;AACpB,YAAA,MAAM,EAAE,GAAG;YACX,SAAS,EAAE,CAAC,GAAG;YACf,MAAM,EAAE,CAAC,CAAC;SACX,CAAA;AACF,KAAA;IACD,OAAO,KAAK,CAAC,aAAa,CACxB,YAAY,IAAI,YAAY,EAC5B,KAAK,CACN,CAAA;AACH,CAAC;AAEK,MAAA,YAAY,GAAG,KAAK,CAAC,UAAU,CACnC,SAAS,YAAY,CAAE,KAAK,EAAE,GAAG,EAAA;AAC/B,IAAA,MAAM,EAMF,GAAA,KAAkC,EANhC,EACJ,EAAE,EAAE,SAAS,EAAE,KAAK,EAAE,QAAQ,EAC9B,gBAAgB,EAAE,gBAAgB,EAClC,QAAQ,EAAE,cAAc,EACxB,SAAS,EAAE,YAAY,EAAA,GAAA,EAEa,EADjC,IAAI,GALH,MAAA,CAAA,EAAA,EAAA,CAAA,IAAA,EAAA,WAAA,EAAA,OAAA,EAAA,UAAA,EAAA,kBAAA,EAAA,kBAAA,EAAA,UAAA,EAAA,gBAAA,EAAA,WAAA,EAAA,cAAA,CAML,CAAqC,CAAA;AACtC,IAAA,MAAM,YAAY,GAAG,CAAC,KAAwE,KAAI;AAChG,QAAA,QAAQ,KAAR,IAAA,IAAA,QAAQ,KAAR,KAAA,CAAA,GAAA,KAAA,CAAA,GAAA,QAAQ,iCACH,KAAY,CAAA,EAAA,EACf,aAAa,EAAE,MACV,CAAA,MAAA,CAAA,MAAA,CAAA,MAAA,CAAA,EAAA,EAAA,KAAK,CAAC,MAAM,KACf,WAAW,EAAE,aAAa,CAAC,KAAK,CAAC,KAAK,CAAC,EACvC,YAAY,EAAE,aAAa,CAAC,KAAK,CAAC,MAAM,CAAC,EAAA,CACnC,IACR,CAAA;AAEF,QAAA,IAAI,OAAO,cAAc,KAAK,UAAU,EAAE;YACxC,cAAc,CAAC,KAAK,CAAC,CAAA;AACtB,SAAA;AACH,KAAC,CAAA;AAED,IAAA,OAAO,KAAK,CAAC,aAAa,CAAM,gBAAgB,kBAC9C,GAAG;QACH,EAAE;QACF,SAAS;QACT,KAAK,EACL,OAAO,EAAE,IAAI,EACb,QAAQ,EAAE,YAAY,EACnB,EAAA,IAAI,CACN,EAAA;AACD,QAAA,oBAAoB,CAAC;AACnB,YAAA,SAAS,EAAE,KAAK;YAChB,EAAE;AACF,YAAA,YAAY,EAAE,gBAAgB;AAC9B,YAAA,YAAY,EAAE,SAAS;SACxB,CAAC;QACF,QAAQ;AACR,QAAA,oBAAoB,CAAC;AACnB,YAAA,SAAS,EAAE,QAAQ;YACnB,EAAE;AACF,YAAA,YAAY,EAAE,gBAAgB;AAC9B,YAAA,YAAY,EAAE,YAAY;SAC3B,CAAC;AACH,KAAA,CAAC,CAAA;AACJ,CAAC;;;;"}