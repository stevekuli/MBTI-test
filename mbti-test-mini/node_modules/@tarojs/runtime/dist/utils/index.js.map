{"version":3,"file":"index.js","sources":["../../src/utils/index.ts"],"sourcesContent":["import {\n  getComponentsAlias as _getComponentsAlias,\n  internalComponents,\n  isFunction,\n  Shortcuts\n} from '@tarojs/shared'\n\nimport {\n  CLASS,\n  COMMENT,\n  ID,\n  ROOT_STR,\n  STYLE,\n  UID\n} from '../constants'\nimport { NodeType } from '../dom/node_types'\n\nimport type { TaroElement } from '../dom/element'\nimport type { TaroNode } from '../dom/node'\nimport type { TaroText } from '../dom/text'\nimport type { TFunc } from '../interface'\n\nexport const incrementId = () => {\n  const chatCodes: number[] = []\n  // A-Z\n  for (let i = 65; i <= 90; i++) {\n    chatCodes.push(i)\n  }\n  // a-z\n  for (let i = 97; i <= 122; i++) {\n    chatCodes.push(i)\n  }\n  const chatCodesLen = chatCodes.length - 1\n  const list = [0, 0]\n  return () => {\n    const target = list.map(item => chatCodes[item])\n    const res = String.fromCharCode(...target)\n\n    let tailIdx = list.length - 1\n\n    list[tailIdx]++\n\n    while (list[tailIdx] > chatCodesLen) {\n      list[tailIdx] = 0\n      tailIdx = tailIdx - 1\n      if (tailIdx < 0) {\n        list.push(0)\n        break\n      }\n      list[tailIdx]++\n    }\n\n    return res\n  }\n}\n\nexport function isElement (node: TaroNode): node is TaroElement {\n  return node.nodeType === NodeType.ELEMENT_NODE\n}\n\nexport function isText (node: TaroNode): node is TaroText {\n  return node.nodeType === NodeType.TEXT_NODE\n}\n\nexport function isComment (node: TaroNode): boolean {\n  return node.nodeName === COMMENT\n}\n\nexport function isHasExtractProp (el: TaroElement): boolean {\n  const res = Object.keys(el.props).find(prop => {\n    return !(/^(class|style|id)$/.test(prop) || prop.startsWith('data-'))\n  })\n  return Boolean(res)\n}\n\n/**\n * 往上寻找组件树直到 root，寻找是否有祖先组件绑定了同类型的事件\n * @param node 当前组件\n * @param type 事件类型\n */\nexport function isParentBinded (node: TaroElement | null, type: string): boolean {\n  while ((node = node?.parentElement || null)) {\n    if (!node || node.nodeName === ROOT_STR || node.nodeName === 'root-portal') {\n      return false\n    } else if (node.__handlers[type]?.length) {\n      return true\n    }\n  }\n\n  return false\n}\n\nexport function shortcutAttr (key: string): string {\n  switch (key) {\n    case STYLE:\n      return Shortcuts.Style\n    case ID:\n      return UID\n    case CLASS:\n      return Shortcuts.Class\n    default:\n      return key\n  }\n}\n\nexport const customWrapperCache = new Map<string, Record<string, any>>()\n\ninterface Ctor {\n  new (...args: any[]): any\n}\n\nexport function extend (ctor: Ctor, methodName: string, options: TFunc | Record<string, any>) {\n  if (isFunction(options)) {\n    options = {\n      value: options\n    }\n  }\n  Object.defineProperty(ctor.prototype, methodName, {\n    configurable: true,\n    enumerable: true,\n    ...options\n  })\n}\n\nlet componentsAlias\nexport function getComponentsAlias () {\n  if (!componentsAlias) {\n    componentsAlias = _getComponentsAlias(internalComponents)\n  }\n  return componentsAlias\n}\n\nexport * from './lodash'\n"],"names":["_getComponentsAlias"],"mappings":"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"}